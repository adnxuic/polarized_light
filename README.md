# 偏振光参数转换器

[![Python Version](https://img.shields.io/badge/python-3.11%2B-blue.svg)](https://python.org)
[![PySide6](https://img.shields.io/badge/GUI-PySide6-green.svg)](https://pyside.org)
[![License](https://img.shields.io/badge/license-MIT-orange.svg)](LICENSE)

偏振分析仪数据处理工具，用于将光学参数精确转换为斯托克斯参数，提供完整的图形用户界面和多种可视化模式。

## ✨ 功能特性

### 📊 数据处理能力

- **多格式支持**：导入偏振分析仪数据文件（.txt, .csv, .dat格式）
- **自动转换**：精确转换光学参数为斯托克斯参数 (S0, S1, S2, S3)
- **编码处理**：智能处理多种文件编码格式

### 🎯 可视化模式

- **数据表格模式**：显示完整的数据表格和统计信息
- **庞加莱球模式**：在庞加莱球面上3D显示偏振状态
- **极坐标动画**：S1和S2参数的动态极坐标显示
- **参数趋势图**：S1、S2、S3参数随时间的变化曲线
- **实时预览**：支持数据实时更新和交互操作

## 🔧 安装配置

### 快速安装

1. **克隆项目**

```bash
git clone https://github.com/adnxuic/polarized_light.git
```

2. **安装依赖**

```bash
pip install -r requirements.txt
```

3. **启动程序**

```bash
python main.py
```

### 依赖包详情

```txt
# 核心科学计算
numpy>=1.21.0          # 数值计算和矩阵操作
pandas>=1.3.0          # 数据结构和分析
scipy>=1.7.0           # 高级科学计算

# GUI框架
PySide6>=6.4.0         # Qt6图形界面框架

# 数据可视化
matplotlib>=3.5.0      # 2D/3D绘图和动画

# 文件处理
chardet>=4.0.0         # 文件编码自动检测
```

## 🚀 使用指南

### 基本工作流程

#### 1️⃣ 数据导入

**1：菜单导入**

- "导入数据"按钮选择数据文件

**2：拖拽导入**

- 直接拖拽文件到主窗口

> [!TIP]
> 直接从偏振分析仪导出数据文件不能直接导入，需要先打开复制，然后粘贴到一个新的txt文件中。

#### 2️⃣ 模式选择

在右侧控制面板选择显示模式：

- **数据模式**：查看原始数据和转换结果
- **庞加莱球**：3D偏振状态可视化
- **动画模式**：参数变化动态演示
- **趋势分析**：S1/S2/S3参数时序图

#### 3️⃣ 结果分析

- **实时计算**：自动更新斯托克斯参数
- **统计信息**：显示数据统计和偏振特性
- **交互操作**：缩放、旋转、标注图表

#### 4️⃣ 数据导出

- **斯托克斯参数**：导出为CSV/Excel格式
- **图表保存**：PNG/PDF/SVG高质量图片

## 📁 项目结构

```
polarized_light/
├── 📄 main.py                    # 🚀 程序主入口
├── 📄 requirements.txt           # 📦 依赖包列表
├── 📄 README.md                  # 📖 项目说明
├── 📁 data/                      # 💾 数据文件目录
│   ├── 📄 datatest.txt          #     测试数据样本
│   └── 📄 stokes_results.csv    #     输出结果示例
├── 📁 src/                       # 💻 源代码目录
│   ├── 📁 component/             #     🧮 核心计算组件
│   │   └── 📄 StokesParameters.py #         斯托克斯参数转换器
│   └── 📁 gui/                   #     🖼️ 图形界面模块
│       ├── 📄 main_window.py     #         主窗口控制器
│       ├── 📄 left_panel.py      #         文件浏览面板
│       ├── 📄 right_panel.py     #         模式控制面板
│       └── 📄 plot_widget.py     #         图表绘制组件
├── 📁 docs/                      # 📚 文档目录
│   └── 📄 parameter.txt          #     光学参数说明
└── 📁 test/                      # 🧪 测试文件目录
```

## 📊 数据格式规范

### 输入文件格式

程序支持标准偏振分析仪导出格式，必须包含以下列：

| 列名              | 描述       | 单位 | 范围        |
| ----------------- | ---------- | ---- | ----------- |
| `No`            | 数据点序号 | -    | 1, 2, 3...  |
| `PER [dB]`      | 偏振消光比 | dB   | -∞ ~ +∞   |
| `φ [°]`       | 方位角     | 度   | 0° ~ 360° |
| `DOP [%]`       | 偏振度     | %    | 0% ~ 100%   |
| `Intensity [%]` | 相对强度   | %    | 0% ~ 100%   |
| `Timestamp`     | 时间戳     | -    | 可选        |

### Example：

```txt
Polarization Analyzer Results

No	PER [dB]	Lin. PER [dB]	Lin. V	φ [°]	DOP [%]	Intensity [%]	Intensity bar	Comment	Timestamp
1	2.7	2.0	2	23.4	78.6	7.8	0	comment is empty	28.05.2025, 19:33:12
2	2.7	2.0	2	23.3	78.6	7.7	0	comment is empty	28.05.2025, 19:33:13
3	2.7	2.0	2	23.4	78.6	7.8	0	comment is empty	28.05.2025, 19:33:14
```

### 输出格式

转换后的斯托克斯参数包含：

- **S0**：总强度参数
- **S1**：水平/垂直线偏振分量
- **S2**：45°/135°线偏振分量
- **S3**：左/右圆偏振分量

## ⌨️ 快捷键

| 快捷键     | 功能             | 说明               |
| ---------- | ---------------- | ------------------ |
| `Ctrl+O` | 导入数据文件     | 打开文件选择对话框 |
| `Ctrl+S` | 导出斯托克斯参数 | 保存转换结果       |
| `Ctrl+P` | 导出图表         | 保存当前图表       |
| `F5`     | 刷新数据目录     | 重新扫描data目录   |
| `Ctrl+Q` | 退出程序         | 安全关闭应用       |
| `Ctrl+Z` | 撤销操作         | 回退上一步操作     |
| `Space`  | 播放/暂停动画    | 控制动画播放       |

## 🔬 科学原理

### 斯托克斯参数理论

斯托克斯参数是描述光偏振状态的完整参数集：

$$
\begin{pmatrix}
S_0 \\
S_1 \\
S_2 \\
S_3
\end{pmatrix} = 
\begin{pmatrix}
I_x + I_y \\
I_x - I_y \\
I_{45°} - I_{135°} \\
I_{RCP} - I_{LCP}
\end{pmatrix}
$$

### 转换算法

基于测量的光学参数，程序实现以下转换：

1. **偏振度转换**：DOP → 归一化强度
2. **方位角处理**：φ → 偏振方向
3. **消光比计算**：PER → 偏振对比度
4. **斯托克斯合成**：综合计算四个斯托克斯参数


## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。


---

⭐ 如果这个项目对您有帮助，请给我们一个Star！
